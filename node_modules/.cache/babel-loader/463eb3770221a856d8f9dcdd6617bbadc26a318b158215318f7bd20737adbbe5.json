{"ast":null,"code":"'use strict';\n\nconst util = require('xutil');\nconst childProcess = require('child_process');\nvar _ = util.merge({}, util);\n_.exec = function (cmd, opts) {\n  return new Promise(function (resolve, reject) {\n    childProcess.exec(cmd, _.merge({\n      maxBuffer: 1024 * 512,\n      wrapArgs: false\n    }, opts || {}), function (err, stdout) {\n      if (err) {\n        return reject(err);\n      }\n      resolve(_.trim(stdout));\n    });\n  });\n};\n_.sleep = function (ms) {\n  return new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n};\n_.retry = function (func, interval, num) {\n  return new Promise((resolve, reject) => {\n    func().then(resolve, err => {\n      if (num > 0 || typeof num === 'undefined') {\n        _.sleep(interval).then(() => {\n          resolve(_.retry(func, interval, num - 1));\n        });\n      } else {\n        reject(err);\n      }\n    });\n  });\n};\n_.waitForCondition = function (func, wait /*ms*/, interval /*ms*/) {\n  wait = wait || 5000;\n  interval = interval || 500;\n  let start = Date.now();\n  let end = start + wait;\n  const fn = function () {\n    return new Promise(function (resolve, reject) {\n      const continuation = (res, rej) => {\n        let now = Date.now();\n        if (now < end) {\n          res(_.sleep(interval).then(fn));\n        } else {\n          rej(`Wait For Condition timeout ${wait}`);\n        }\n      };\n      func().then(isOk => {\n        if (!!isOk) {\n          resolve();\n        } else {\n          continuation(resolve, reject);\n        }\n      }).catch(() => {\n        continuation(resolve, reject);\n      });\n    });\n  };\n  return fn();\n};\n_.spawn = function () {\n  var args = Array.prototype.slice.call(arguments);\n  return new Promise((resolve, reject) => {\n    var stdout = '';\n    var stderr = '';\n    var child = childProcess.spawn.apply(childProcess, args);\n    child.on('error', error => {\n      reject(error);\n    });\n    child.stdout.on('data', data => {\n      stdout += data;\n    });\n    child.stderr.on('data', data => {\n      stderr += data;\n    });\n    child.on('close', code => {\n      var error;\n      if (code) {\n        error = new Error(stderr);\n        error.code = code;\n        return reject(error);\n      }\n      resolve([stdout, stderr]);\n    });\n  });\n};\nvar Defer = function () {\n  this._resolve = null;\n  this._reject = null;\n  this.promise = new Promise((resolve, reject) => {\n    this._resolve = resolve;\n    this._reject = reject;\n  });\n};\nDefer.prototype.resolve = function (data) {\n  this._resolve(data);\n};\nDefer.prototype.reject = function (err) {\n  this._reject(err);\n};\n_.Defer = Defer;\nfunction CustomQueue() {\n  this.queue = [];\n}\nCustomQueue.prototype.add = function (handle) {\n  this.queue.push(handle.bind(this));\n};\nCustomQueue.prototype.next = function () {\n  var current = this.queue.shift();\n  setTimeout(() => {\n    current && current();\n  }, 1000);\n};\n_.CustomQueue = CustomQueue;\n_.setProtocol = res => {\n  res.protocol = 'HTTP';\n  if (res.socket._spdyState) {\n    var spdyState = res.socket._spdyState.parent;\n    var protocol = spdyState.alpnProtocol || spdyState.npnProtocol;\n    var parts = protocol.match(/^([^\\/\\d]+)\\/?(\\d+)(?:\\.(\\d+))?/i);\n    if (parts) {\n      res.protocol = parts[1] === 'h' ? 'HTTP' : parts[1].toUpperCase();\n      res.httpVersionMajor = parts[2];\n      res.httpVersionMinor = parts[3] || 0;\n      res.httpVersion = `${res.httpVersionMajor}.${res.httpVersionMinor}`;\n    }\n  }\n};\nmodule.exports = _;","map":{"version":3,"names":["util","require","childProcess","_","merge","exec","cmd","opts","Promise","resolve","reject","maxBuffer","wrapArgs","err","stdout","trim","sleep","ms","setTimeout","retry","func","interval","num","then","waitForCondition","wait","start","Date","now","end","fn","continuation","res","rej","isOk","catch","spawn","args","Array","prototype","slice","call","arguments","stderr","child","apply","on","error","data","code","Error","Defer","_resolve","_reject","promise","CustomQueue","queue","add","handle","push","bind","next","current","shift","setProtocol","protocol","socket","_spdyState","spdyState","parent","alpnProtocol","npnProtocol","parts","match","toUpperCase","httpVersionMajor","httpVersionMinor","httpVersion","module","exports"],"sources":["/home/lenovo/node_modules/net-tools/lib/helper.js"],"sourcesContent":["'use strict';\n\nconst util = require('xutil');\nconst childProcess = require('child_process');\n\nvar _ = util.merge({}, util);\n\n_.exec = function(cmd, opts) {\n  return new Promise(function(resolve, reject) {\n    childProcess.exec(cmd, _.merge({\n      maxBuffer: 1024 * 512,\n      wrapArgs: false\n    }, opts || {}), function(err, stdout) {\n      if (err) {\n        return reject(err);\n      }\n      resolve(_.trim(stdout));\n    });\n  });\n};\n\n_.sleep = function(ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n};\n\n_.retry = function(func, interval, num) {\n  return new Promise((resolve, reject) => {\n    func().then(resolve, err => {\n      if (num > 0 || typeof num === 'undefined') {\n        _.sleep(interval).then(() => {\n          resolve(_.retry(func, interval, num - 1));\n        });\n      } else {\n        reject(err);\n      }\n    });\n  });\n};\n\n_.waitForCondition = function(func, wait/*ms*/, interval/*ms*/) {\n  wait = wait || 5000;\n  interval = interval || 500;\n  let start = Date.now();\n  let end = start + wait;\n  const fn = function() {\n    return new Promise(function(resolve, reject) {\n      const continuation = (res, rej) => {\n        let now = Date.now();\n        if (now < end) {\n          res(_.sleep(interval).then(fn));\n        } else {\n          rej(`Wait For Condition timeout ${wait}`);\n        }\n      };\n      func().then(isOk => {\n        if (!!isOk) {\n          resolve();\n        } else {\n          continuation(resolve, reject);\n        }\n      }).catch(() => {\n        continuation(resolve, reject);\n      });\n    });\n  };\n  return fn();\n};\n\n_.spawn = function() {\n  var args = Array.prototype.slice.call(arguments);\n\n  return new Promise((resolve, reject) => {\n    var stdout = '';\n    var stderr = '';\n    var child = childProcess.spawn.apply(childProcess, args);\n\n    child.on('error', error => {\n      reject(error);\n    });\n\n    child.stdout.on('data', data => {\n      stdout += data;\n    });\n\n    child.stderr.on('data', data => {\n      stderr += data;\n    });\n\n    child.on('close', code => {\n      var error;\n      if (code) {\n        error = new Error(stderr);\n        error.code = code;\n        return reject(error);\n      }\n      resolve([stdout, stderr]);\n    });\n  });\n};\n\nvar Defer = function() {\n  this._resolve = null;\n  this._reject = null;\n  this.promise = new Promise((resolve, reject) => {\n    this._resolve = resolve;\n    this._reject = reject;\n  });\n};\n\nDefer.prototype.resolve = function(data) {\n  this._resolve(data);\n};\n\nDefer.prototype.reject = function(err) {\n  this._reject(err);\n};\n\n_.Defer = Defer;\n\nfunction CustomQueue() {\n  this.queue = [];\n}\n\nCustomQueue.prototype.add = function(handle) {\n  this.queue.push(handle.bind(this));\n};\n\nCustomQueue.prototype.next = function() {\n  var current = this.queue.shift();\n\n  setTimeout(() => {\n    current && current();\n  }, 1000);\n};\n\n_.CustomQueue = CustomQueue;\n\n_.setProtocol = res => {\n  res.protocol = 'HTTP';\n  if (res.socket._spdyState) {\n    var spdyState = res.socket._spdyState.parent;\n    var protocol = spdyState.alpnProtocol || spdyState.npnProtocol;\n    var parts = protocol.match(/^([^\\/\\d]+)\\/?(\\d+)(?:\\.(\\d+))?/i);\n    if (parts) {\n      res.protocol = parts[1] === 'h' ? 'HTTP' : parts[1].toUpperCase();\n      res.httpVersionMajor = parts[2];\n      res.httpVersionMinor = parts[3] || 0;\n      res.httpVersion = `${res.httpVersionMajor}.${res.httpVersionMinor}`;\n    }\n  }\n};\n\nmodule.exports = _;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}